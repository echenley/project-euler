# Let d(n) be defined as the sum of proper divisors of n
# (numbers less than n which divide evenly into n).
# If d(a) = b and d(b) = a, where a â‰  b, then a and b are an
# amicable pair and each of a and b are called amicable numbers.

# For example, the proper divisors of 220 are 1, 2, 4, 5, 10,
# 11, 20, 22, 44, 55 and 110; therefore d(220) = 284. The proper
# divisors of 284 are 1, 2, 4, 71 and 142; so d(284) = 220.

# Evaluate the sum of all the amicable numbers under 10000.

def amicable(limit)
  sums = {}
  amicables = []
  for num in 2...limit do
    divisors,div = [],1
    for div in 1..Math.sqrt(num).floor
      if num % div == 0
        other_div = num / div
        divisors << div << other_div
      end
      num.odd? ? div += 2 : div += 1
    end
    sum_of_divisors = divisors.inject(:+)
    sums[num] = sum_of_divisors
  end
  sums.each do |key,value|
    amicables << sums[key] << sums[value] if sums[key] == sums[value]
  end
  amicables
end

amicable(20)
