# Which starting number, under one million, produces the longest Collatz chain?

def collatz(start)
  n = start               # start value copied to variable
  shortcut ||= {}
  length = 1
  while n != 1
    length + shortcut[n] if shortcut[n]?
    n.odd? ? (n = 3 * n + 1) : (n = n / 2)
    length += 1
  end
  shortcut[start] = length
  return length
end

def longest_chain(limit)
  n = 13
  longest = [1,0]
  while n < limit
    length = collatz(n)
    longest = [n,length] if length > longest[1]
    n += 1
  end
  longest
end

p longest_chain(1000000)
